# Redis Session Configuration
# Copy this to your .env.local file and adjust values as needed

# ============================================================================
# Redis Connection
# ============================================================================

# Redis connection URL
# Local development (default):
REDIS_URL=redis://localhost:6379

# Production with password:
# REDIS_URL=redis://:your-password@production-host:6379

# Redis Cluster:
# REDIS_URL=redis://host1:6379,host2:6379,host3:6379

# ============================================================================
# Feature Flags
# ============================================================================

# Enable Redis-backed sessions
# Set to 'false' to use iron-session only (safe fallback)
REDIS_SESSIONS_ENABLED=true

# Percentage of requests to use Redis (0-100)
# Use for gradual rollout:
#   Start: 10
#   After 24h: 50
#   After 48h: 100
REDIS_SESSIONS_ROLLOUT_PERCENTAGE=100

# Enable Redis-based rate limiting
# Defaults to same value as REDIS_SESSIONS_ENABLED if not set
REDIS_RATE_LIMIT_ENABLED=true

# Enable session activity tracking (updates lastActivity on each request)
# Set to 'false' to reduce Redis writes
SESSION_ACTIVITY_TRACKING_ENABLED=true

# Enable verbose session logging
# Automatically enabled in development mode
VERBOSE_SESSION_LOGGING=false

# ============================================================================
# Rate Limiting
# ============================================================================

# Maximum requests per window per IP
RATE_LIMIT_MAX_REQUESTS=100

# Time window in milliseconds (60000 = 1 minute)
RATE_LIMIT_WINDOW_MS=60000

# ============================================================================
# Existing Configuration (for reference)
# ============================================================================

# Cookie secret (required by iron-session)
# COOKIE_SECRET=your-32-character-secret-key

# Session cookie name
# SCIX_SESSION_COOKIE_NAME=scix_session

# ADS API session cookie name
# ADS_SESSION_COOKIE_NAME=session

# API host for server-side requests
# API_HOST_SERVER=https://api.adsabs.harvard.edu

# ============================================================================
# Development Tips
# ============================================================================

# 1. Start Redis locally:
#    macOS:     brew install redis && brew services start redis
#    Ubuntu:    sudo apt-get install redis-server && sudo systemctl start redis
#    Docker:    docker run -d -p 6379:6379 redis:latest

# 2. Verify Redis is running:
#    redis-cli ping
#    (should respond with "PONG")

# 3. Monitor Redis:
#    redis-cli MONITOR

# 4. Check health:
#    curl http://localhost:8000/api/health

# 5. Disable Redis if needed:
#    REDIS_SESSIONS_ENABLED=false
